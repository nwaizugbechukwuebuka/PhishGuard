# PhishGuard Environment Configuration Template
# Copy this file to .env and fill in your actual values
# IMPORTANT: Never commit .env to version control

# ================================
# APPLICATION SETTINGS
# ================================

# Application environment (development, staging, production)
APP_ENV=development

# Application name and version
APP_NAME=PhishGuard
APP_VERSION=1.0.0

# Debug mode (true/false) - NEVER enable in production
DEBUG=true

# Application host and port
HOST=0.0.0.0
PORT=8000

# Frontend URL (for CORS configuration)
FRONTEND_URL=http://localhost:3000

# ================================
# SECURITY CONFIGURATION
# ================================

# Secret key for JWT tokens and encryption (generate a strong random key)
SECRET_KEY=your-super-secret-key-change-this-in-production

# JWT configuration
JWT_SECRET_KEY=your-jwt-secret-key-change-this
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

# Password hashing configuration
PASSWORD_HASH_ROUNDS=12

# Encryption key for sensitive data (32-byte base64 encoded)
ENCRYPTION_KEY=your-encryption-key-for-sensitive-data

# CORS origins (comma-separated list)
CORS_ORIGINS=http://localhost:3000,https://yourdomain.com

# Rate limiting
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_BURST=20

# ================================
# DATABASE CONFIGURATION
# ================================

# PostgreSQL database connection
DATABASE_URL=postgresql://phishguard:password@localhost:5432/phishguard

# Database pool settings
DATABASE_POOL_SIZE=10
DATABASE_MAX_OVERFLOW=20
DATABASE_POOL_TIMEOUT=30

# ================================
# REDIS CONFIGURATION
# ================================

# Redis connection for caching and session storage
REDIS_URL=redis://localhost:6379/0

# Redis configuration
REDIS_PASSWORD=
REDIS_DB=0
REDIS_POOL_SIZE=10

# ================================
# EMAIL CONFIGURATION
# ================================

# SMTP settings for sending notifications
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USE_TLS=true
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password

# Email sender configuration
EMAIL_FROM=alerts@yourdomain.com
EMAIL_FROM_NAME=PhishGuard Security

# Email templates directory
EMAIL_TEMPLATES_DIR=src/templates/email

# ================================
# AI/ML CONFIGURATION
# ================================

# AI Engine settings
AI_ENGINE_ENABLED=true
ML_MODEL_PATH=models/
THREAT_DETECTION_THRESHOLD=0.7
CONFIDENCE_THRESHOLD=0.8

# Feature extraction settings
ENABLE_CONTENT_ANALYSIS=true
ENABLE_URL_ANALYSIS=true
ENABLE_ATTACHMENT_SCANNING=true
ENABLE_SENDER_REPUTATION=true

# Model update frequency (in hours)
MODEL_UPDATE_FREQUENCY=24

# ================================
# QUARANTINE CONFIGURATION
# ================================

# Quarantine storage settings
QUARANTINE_STORAGE_PATH=src/quarantine_storage
QUARANTINE_ENCRYPTION_ENABLED=true
QUARANTINE_RETENTION_DAYS=90

# Quarantine file size limits (in MB)
MAX_QUARANTINE_FILE_SIZE=100
MAX_QUARANTINE_TOTAL_SIZE=10240

# Auto-cleanup settings
QUARANTINE_AUTO_CLEANUP=true
QUARANTINE_CLEANUP_FREQUENCY=daily

# ================================
# CELERY CONFIGURATION
# ================================

# Celery broker (Redis)
CELERY_BROKER_URL=redis://localhost:6379/1

# Celery result backend
CELERY_RESULT_BACKEND=redis://localhost:6379/2

# Celery task settings
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=["json"]
CELERY_TIMEZONE=UTC

# Task time limits (in seconds)
CELERY_TASK_TIME_LIMIT=300
CELERY_TASK_SOFT_TIME_LIMIT=240

# ================================
# EXTERNAL INTEGRATIONS
# ================================

# VirusTotal API
VIRUSTOTAL_API_KEY=your-virustotal-api-key
VIRUSTOTAL_RATE_LIMIT=4

# URLVoid API
URLVOID_API_KEY=your-urlvoid-api-key
URLVOID_API_URL=http://api.urlvoid.com/

# Gmail API (for email provider integration)
GMAIL_CLIENT_ID=your-gmail-client-id
GMAIL_CLIENT_SECRET=your-gmail-client-secret
GMAIL_REDIRECT_URI=http://localhost:8000/auth/gmail/callback

# Microsoft 365 API
MICROSOFT365_CLIENT_ID=your-microsoft365-client-id
MICROSOFT365_CLIENT_SECRET=your-microsoft365-client-secret
MICROSOFT365_TENANT_ID=your-tenant-id

# Slack integration
SLACK_BOT_TOKEN=xoxb-your-slack-bot-token
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
SLACK_SECURITY_CHANNEL=#security-alerts

# Microsoft Teams integration
TEAMS_WEBHOOK_URL=https://yourorg.webhook.office.com/webhookb2/YOUR-WEBHOOK-URL

# ================================
# SIEM/SOAR INTEGRATIONS
# ================================

# Splunk integration
SPLUNK_HOST=your-splunk-server.com
SPLUNK_PORT=8089
SPLUNK_USERNAME=phishguard
SPLUNK_PASSWORD=your-splunk-password
SPLUNK_INDEX=phishguard

# QRadar integration  
QRADAR_HOST=your-qradar-server.com
QRADAR_TOKEN=your-qradar-api-token
QRADAR_VERIFY_SSL=true

# Generic SIEM webhook
SIEM_WEBHOOK_URL=https://your-siem.com/webhook/phishguard
SIEM_WEBHOOK_TOKEN=your-webhook-token

# ================================
# THREAT INTELLIGENCE
# ================================

# Threat intelligence feeds
THREAT_INTEL_FEEDS=malware_bazaar,urlhaus,phishtank
THREAT_INTEL_UPDATE_FREQUENCY=6

# Custom threat intelligence
CUSTOM_THREAT_FEED_URL=https://your-threat-feed.com/api/indicators
CUSTOM_THREAT_FEED_TOKEN=your-threat-feed-token

# Reputation services
ENABLE_IP_REPUTATION=true
ENABLE_DOMAIN_REPUTATION=true
ENABLE_URL_REPUTATION=true

# ================================
# MONITORING & LOGGING
# ================================

# Logging configuration
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE_PATH=logs/phishguard.log
LOG_MAX_SIZE=100MB
LOG_BACKUP_COUNT=10

# Application monitoring
ENABLE_METRICS=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Health check configuration
HEALTH_CHECK_ENDPOINT=/health
HEALTH_CHECK_TIMEOUT=30

# Error tracking (Sentry)
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id
SENTRY_ENVIRONMENT=development

# ================================
# COMPLIANCE & AUDIT
# ================================

# GDPR compliance settings
GDPR_ENABLED=true
DATA_RETENTION_DAYS=2555  # 7 years
ENABLE_DATA_ANONYMIZATION=true

# Audit logging
AUDIT_LOG_ENABLED=true
AUDIT_LOG_LEVEL=INFO
AUDIT_LOG_FILE=logs/audit.log

# Compliance reporting
COMPLIANCE_REPORTS_ENABLED=true
COMPLIANCE_EXPORT_FORMAT=json

# ================================
# PERFORMANCE SETTINGS
# ================================

# API performance
API_RATE_LIMIT=1000
API_BURST_LIMIT=100
API_TIMEOUT=30

# Database performance
DATABASE_QUERY_TIMEOUT=30
DATABASE_CONNECTION_TIMEOUT=10

# Cache settings
CACHE_TTL=3600
CACHE_MAX_SIZE=1000

# ================================
# DEVELOPMENT SETTINGS
# ================================

# Development features (disable in production)
ENABLE_API_DOCS=true
ENABLE_DEBUG_TOOLBAR=false
ENABLE_PROFILING=false

# Testing configuration
TEST_DATABASE_URL=postgresql://phishguard:password@localhost:5432/phishguard_test
PYTEST_TIMEOUT=30

# Mock external services in development
MOCK_EXTERNAL_APIS=false
MOCK_EMAIL_SENDING=true

# ================================
# PRODUCTION OVERRIDES
# ================================

# Production-specific settings (uncomment when deploying)
# DEBUG=false
# MOCK_EMAIL_SENDING=false
# MOCK_EXTERNAL_APIS=false
# LOG_LEVEL=WARNING
# ENABLE_API_DOCS=false

# Production database with connection pooling
# DATABASE_URL=postgresql://user:pass@prod-db:5432/phishguard?sslmode=require

# Production Redis with authentication
# REDIS_URL=redis://:password@prod-redis:6379/0

# Production email with dedicated SMTP
# SMTP_HOST=smtp.yourdomain.com
# SMTP_PORT=587
# EMAIL_FROM=noreply@yourdomain.com

# ================================
# DOCKER CONFIGURATION
# ================================

# Docker-specific overrides
DOCKER_ENV=false

# Container health checks
CONTAINER_HEALTH_CHECK_INTERVAL=30s
CONTAINER_HEALTH_CHECK_TIMEOUT=10s
CONTAINER_HEALTH_CHECK_RETRIES=3

# ================================
# KUBERNETES CONFIGURATION
# ================================

# Kubernetes deployment settings
K8S_NAMESPACE=phishguard
K8S_SERVICE_ACCOUNT=phishguard-sa

# Pod resource limits
POD_CPU_LIMIT=2000m
POD_MEMORY_LIMIT=4Gi
POD_CPU_REQUEST=500m
POD_MEMORY_REQUEST=1Gi

# ================================
# BACKUP & RECOVERY
# ================================

# Backup configuration
BACKUP_ENABLED=true
BACKUP_FREQUENCY=daily
BACKUP_RETENTION_DAYS=30

# Backup storage
BACKUP_STORAGE_TYPE=s3
BACKUP_S3_BUCKET=phishguard-backups
BACKUP_S3_REGION=us-east-1
BACKUP_S3_ACCESS_KEY=your-s3-access-key
BACKUP_S3_SECRET_KEY=your-s3-secret-key

# Database backup
DB_BACKUP_ENABLED=true
DB_BACKUP_FORMAT=custom
DB_BACKUP_COMPRESSION=gzip

# Security Configuration
SECRET_KEY=your-super-secure-secret-key-change-in-production
JWT_SECRET_KEY=your-jwt-secret-key-change-in-production
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=30

# CORS Settings
ALLOWED_ORIGINS=["http://localhost:3000", "https://your-domain.com"]
ALLOWED_METHODS=["GET", "POST", "PUT", "DELETE"]
ALLOWED_HEADERS=["*"]

# Database Configuration
DATABASE_URL=postgresql+asyncpg://phishguard:password@localhost:5432/phishguard_db
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=30

# Redis Configuration
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=
REDIS_SSL=false

# Celery Configuration
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2
CELERY_TASK_SERIALIZER=json
CELERY_RESULT_SERIALIZER=json
CELERY_ACCEPT_CONTENT=["json"]
CELERY_TIMEZONE=UTC

# Email Configuration
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@company.com
SMTP_PASSWORD=your-app-password
SMTP_TLS=true
SMTP_SSL=false

# Gmail API Configuration
GMAIL_CREDENTIALS_FILE=path/to/gmail-credentials.json
GMAIL_TOKEN_FILE=path/to/gmail-token.json
GMAIL_SCOPES=["https://www.googleapis.com/auth/gmail.readonly"]

# Microsoft 365 Configuration
AZURE_CLIENT_ID=your-azure-client-id
AZURE_CLIENT_SECRET=your-azure-client-secret
AZURE_TENANT_ID=your-azure-tenant-id
MICROSOFT_GRAPH_SCOPES=["https://graph.microsoft.com/Mail.Read"]

# Slack Integration
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
SLACK_BOT_TOKEN=xoxb-your-slack-bot-token
SLACK_CHANNEL=#security-alerts

# AI/ML Configuration
ML_MODEL_PATH=src/ai_engine/models/phishing_classifier.pkl
FEATURE_EXTRACTION_CONFIG=src/ai_engine/config/features.json
ML_CONFIDENCE_THRESHOLD=0.75
ML_BATCH_SIZE=32
ML_MAX_EMAIL_LENGTH=10000

# File Storage
QUARANTINE_STORAGE_PATH=src/quarantine_storage
ATTACHMENT_STORAGE_PATH=src/quarantine_storage/attachments
LOG_STORAGE_PATH=src/quarantine_storage/logs
MAX_ATTACHMENT_SIZE_MB=25

# Monitoring and Observability
PROMETHEUS_METRICS_PORT=8001
LOG_LEVEL=INFO
LOG_FORMAT=json
METRICS_ENABLED=true
TRACING_ENABLED=true

# Rate Limiting
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_BURST_SIZE=10

# SIEM Integration
SIEM_ENDPOINT=https://your-siem.company.com/api/events
SIEM_API_KEY=your-siem-api-key
SIEM_FORMAT=cef

# SOAR Integration
SOAR_ENDPOINT=https://your-soar.company.com/api/incidents
SOAR_API_KEY=your-soar-api-key
SOAR_PLAYBOOK_ID=phishing-response-playbook

# Compliance and Audit
AUDIT_LOG_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=365
COMPLIANCE_REPORTING_ENABLED=true

# Performance Tuning
MAX_WORKERS=4
WORKER_TIMEOUT=30
KEEPALIVE_TIMEOUT=5
MAX_REQUESTS=1000
MAX_REQUESTS_JITTER=50

# Development Settings (Override in .env.local)
DEV_RELOAD=false
DEV_MOCK_AI=false
DEV_MOCK_INTEGRATIONS=false

# Health Check Configuration
HEALTH_CHECK_INTERVAL_SECONDS=60
HEALTH_CHECK_TIMEOUT_SECONDS=10

# Backup and Recovery
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30

# Feature Flags
FEATURE_ADVANCED_ANALYTICS=true
FEATURE_REAL_TIME_SCANNING=true
FEATURE_AUTOMATED_RESPONSE=true
FEATURE_THREAT_INTELLIGENCE=true
